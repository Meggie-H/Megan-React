import{u as B,a as U,r as O,w as K,j as d,o as G,c as z}from"./index-59Jx6Yim.js";function L(a){const{navigate:r}=B(),e=U({strict:!1,select:i=>i.pathname}),t=({from:i,...s})=>r({from:s!=null&&s.to?e:void 0,...s});return O.useCallback(t,[])}class I{constructor(r,e){this.listeners=new Set,this._batching=!1,this._flushing=0,this.subscribe=t=>{var i,s;this.listeners.add(t);const n=(s=(i=this.options)==null?void 0:i.onSubscribe)==null?void 0:s.call(i,t,this);return()=>{this.listeners.delete(t),n==null||n()}},this.setState=t=>{var i,s,n;const o=this.state;this.state=(i=this.options)!=null&&i.updateFn?this.options.updateFn(o)(t):t(o),(n=(s=this.options)==null?void 0:s.onUpdate)==null||n.call(s),this._flush()},this._flush=()=>{if(this._batching)return;const t=++this._flushing;this.listeners.forEach(i=>{this._flushing===t&&i()})},this.batch=t=>{if(this._batching)return t();this._batching=!0,t(),this._batching=!1,this._flush()},this.state=r,this.options=e}}function S(a,r){return typeof a=="function"?a(r):a}function R(a,r){return E(r).reduce((t,i)=>{if(typeof t<"u")return t[i]},a)}function w(a,r,e){const t=E(r);function i(s){if(!t.length)return S(e,s);const n=t.shift();if(typeof n=="string")return typeof s=="object"?{...s,[n]:i(s[n])}:{[n]:i()};if(Array.isArray(s)&&n!==void 0){const o=s.slice(0,n);return[...o.length?o:new Array(n),i(s[n]),...s.slice(n+1)]}return[...new Array(n),i()]}return i(a)}function q(a,r){const e=E(r);function t(i){if(!i)return;if(e.length===1){const n=e[0],{[n]:o,...l}=i;return l}const s=e.shift();if(typeof s=="string"&&typeof i=="object")return{...i,[s]:t(i[s])};if(typeof s=="number"&&Array.isArray(i)){if(s>=i.length)return i;const n=i.slice(0,s);return[...n.length?n:new Array(s),t(i[s]),...i.slice(s+1)]}throw new Error("It seems we have created an infinite loop in deleteBy. ")}return t(a)}const W=/^(\d*)$/gm,H=/\.(\d*)\./gm,J=/^(\d*)\./gm,Q=/\.(\d*$)/gm,X=/\.{2,}/gm,_="__int__",M=`${_}$1`;function E(a){if(typeof a!="string")throw new Error("Path must be a string.");return a.replace("[",".").replace("]","").replace(W,M).replace(H,`.${M}.`).replace(J,`${M}.`).replace(Q,`.${M}`).replace(X,".").split(".").map(r=>r.indexOf(_)===0?parseInt(r.substring(_.length),10):r)}function Y(a){return!(Array.isArray(a)&&a.length===0)}function N(a,r){const{asyncDebounceMs:e}=r,{onChangeAsync:t,onBlurAsync:i,onSubmitAsync:s,onBlurAsyncDebounceMs:n,onChangeAsyncDebounceMs:o,onSubmitAsyncDebounceMs:l}=r.validators||{},h=e??0,u={cause:"change",validate:t,debounceMs:o??h},v={cause:"blur",validate:i,debounceMs:n??h},m={cause:"submit",validate:s,debounceMs:l??h};switch(a){case"submit":return[u,v,m];case"server":return[];case"blur":return[v];case"change":default:return[u]}}function C(a,r){const{onChange:e,onBlur:t,onSubmit:i}=r.validators||{},s={cause:"change",validate:e},n={cause:"blur",validate:t},o={cause:"submit",validate:i},l={cause:"server",validate:()=>{}};switch(a){case"submit":return[s,n,o,l];case"server":return[l];case"blur":return[n,l];case"change":default:return[s,l]}}function x(a){return{values:a.values??{},errors:a.errors??[],errorMap:a.errorMap??{},fieldMeta:a.fieldMeta??{},canSubmit:a.canSubmit??!0,isFieldsValid:a.isFieldsValid??!1,isFieldsValidating:a.isFieldsValidating??!1,isFormValid:a.isFormValid??!1,isFormValidating:a.isFormValidating??!1,isSubmitted:a.isSubmitted??!1,isSubmitting:a.isSubmitting??!1,isTouched:a.isTouched??!1,isPristine:a.isPristine??!0,isDirty:a.isDirty??!1,isValid:a.isValid??!1,isValidating:a.isValidating??!1,submissionAttempts:a.submissionAttempts??0,validationMetaMap:a.validationMetaMap??{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0}}}class Z{constructor(r){var e;this.options={},this.fieldInfo={},this.prevTransformArray=[],this.mount=()=>{const{onMount:t}=this.options.validators||{};if(!t)return;const i=this.runValidator({validate:t,value:{value:this.state.values,formApi:this},type:"validate"});i&&this.store.setState(s=>({...s,errorMap:{...s.errorMap,onMount:i}}))},this.update=t=>{if(!t)return;const i=this.options;this.options=t,this.store.batch(()=>{const s=t.defaultValues&&t.defaultValues!==i.defaultValues&&!this.state.isTouched,n=t.defaultState!==i.defaultState&&!this.state.isTouched;this.store.setState(()=>x(Object.assign({},this.state,n?t.defaultState:{},s?{values:t.defaultValues}:{})))})},this.reset=()=>this.store.setState(()=>{var t;return x({...this.options.defaultState,values:this.options.defaultValues??((t=this.options.defaultState)==null?void 0:t.values)})}),this.validateAllFields=async t=>{const i=[];return this.store.batch(()=>{Object.values(this.fieldInfo).forEach(n=>{if(!n.instance)return;const o=n.instance;i.push(Promise.resolve().then(()=>o.validate(t))),n.instance.state.meta.isTouched||n.instance.setMeta(l=>({...l,isTouched:!0}))})}),(await Promise.all(i)).flat()},this.validateSync=t=>{const i=C(t,this.options);let s=!1;this.store.batch(()=>{for(const o of i){if(!o.validate)continue;const l=T(this.runValidator({validate:o.validate,value:{value:this.state.values,formApi:this},type:"validate"})),h=V(o.cause);this.state.errorMap[h]!==l&&this.store.setState(u=>({...u,errorMap:{...u.errorMap,[h]:l}})),l&&(s=!0)}});const n=V("submit");return this.state.errorMap[n]&&t!=="submit"&&!s&&this.store.setState(o=>({...o,errorMap:{...o.errorMap,[n]:void 0}})),{hasErrored:s}},this.validateAsync=async t=>{const i=N(t,this.options);this.state.isFormValidating||this.store.setState(o=>({...o,isFormValidating:!0}));const s=[];for(const o of i){if(!o.validate)continue;const l=V(o.cause),h=this.state.validationMetaMap[l];h==null||h.lastAbortController.abort();const u=new AbortController;this.state.validationMetaMap[l]={lastAbortController:u},s.push(new Promise(async v=>{let m;try{m=await new Promise((c,p)=>{setTimeout(async()=>{if(u.signal.aborted)return c(void 0);try{c(await this.runValidator({validate:o.validate,value:{value:this.state.values,formApi:this,signal:u.signal},type:"validateAsync"}))}catch(g){p(g)}},o.debounceMs)})}catch(c){m=c}const b=T(m);this.store.setState(c=>({...c,errorMap:{...c.errorMap,[V(t)]:b}})),v(b)}))}let n=[];return s.length&&(n=await Promise.all(s)),this.store.setState(o=>({...o,isFormValidating:!1})),n.filter(Boolean)},this.validate=t=>{const{hasErrored:i}=this.validateSync(t);return i&&!this.options.asyncAlways?this.state.errors:this.validateAsync(t)},this.handleSubmit=async()=>{var t,i,s,n,o,l;if(this.store.setState(u=>({...u,isSubmitted:!1,submissionAttempts:u.submissionAttempts+1})),!this.state.canSubmit)return;this.store.setState(u=>({...u,isSubmitting:!0}));const h=()=>{this.store.setState(u=>({...u,isSubmitting:!1}))};if(await this.validateAllFields("submit"),!this.state.isFieldsValid){h(),(i=(t=this.options).onSubmitInvalid)==null||i.call(t,{value:this.state.values,formApi:this});return}if(await this.validate("submit"),!this.state.isValid){h(),(n=(s=this.options).onSubmitInvalid)==null||n.call(s,{value:this.state.values,formApi:this});return}try{await((l=(o=this.options).onSubmit)==null?void 0:l.call(o,{value:this.state.values,formApi:this})),this.store.batch(()=>{this.store.setState(u=>({...u,isSubmitted:!0})),h()})}catch(u){throw h(),u}},this.getFieldValue=t=>R(this.state.values,t),this.getFieldMeta=t=>this.state.fieldMeta[t],this.getFieldInfo=t=>{var i;return(i=this.fieldInfo)[t]||(i[t]={instance:null,validationMetaMap:{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0}})},this.setFieldMeta=(t,i)=>{this.store.setState(s=>({...s,fieldMeta:{...s.fieldMeta,[t]:S(i,s.fieldMeta[t])}}))},this.setFieldValue=(t,i,s)=>{const n=s==null?void 0:s.touch;this.store.batch(()=>{n&&this.setFieldMeta(t,o=>({...o,isTouched:!0,isDirty:!0})),this.store.setState(o=>({...o,values:w(o.values,t,i)}))})},this.deleteField=t=>{this.store.setState(i=>{const s={...i};return s.values=q(s.values,t),delete s.fieldMeta[t],s}),delete this.fieldInfo[t]},this.pushFieldValue=(t,i,s)=>this.setFieldValue(t,n=>[...Array.isArray(n)?n:[],i],s),this.insertFieldValue=(t,i,s,n)=>{this.setFieldValue(t,o=>o.map((l,h)=>h===i?s:l),n)},this.removeFieldValue=(t,i,s)=>{this.setFieldValue(t,n=>n.filter((o,l)=>l!==i),s)},this.swapFieldValues=(t,i,s)=>{this.setFieldValue(t,n=>{const o=n[i],l=n[s];return w(w(n,`${i}`,l),`${s}`,o)})},this.store=new I(x({...r==null?void 0:r.defaultState,values:(r==null?void 0:r.defaultValues)??((e=r==null?void 0:r.defaultState)==null?void 0:e.values),isFormValid:!0}),{onUpdate:()=>{var t,i;let{state:s}=this.store;const n=Object.values(s.fieldMeta),o=n.some(f=>f==null?void 0:f.isValidating),l=!n.some(f=>(f==null?void 0:f.errorMap)&&Y(Object.values(f.errorMap).filter(Boolean))),h=n.some(f=>f==null?void 0:f.isTouched),u=n.some(f=>f==null?void 0:f.isDirty),v=!u,m=o||s.isFormValidating;s.errors=Object.values(s.errorMap).filter(f=>f!==void 0);const b=s.errors.length===0,c=l&&b,p=s.submissionAttempts===0&&!h||!m&&!s.isSubmitting&&c;s={...s,isFieldsValidating:o,isFieldsValid:l,isFormValid:b,isValid:c,canSubmit:p,isTouched:h,isPristine:v,isDirty:u},this.state=s,this.store.state=this.state;const g=((t=this.options.transform)==null?void 0:t.deps)??[];(g.length!==this.prevTransformArray.length||g.some((f,k)=>f!==this.prevTransformArray[k]))&&((i=this.options.transform)==null||i.fn(this),this.store.state=this.state,this.prevTransformArray=g)}}),this.state=this.store.state,this.update(r||{})}runValidator(r){const e=this.options.validatorAdapter;return e&&typeof r.validate!="function"?e()[r.type](r.value,r.validate):r.validate(r.value)}}function T(a){if(a)return typeof a!="string"?"Invalid Form Values":a}function V(a){switch(a){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"change":default:return"onChange"}}class tt{constructor(r){this.options={},this.mount=()=>{const e=this.getInfo();e.instance=this;const t=this.form.store.subscribe(()=>{this.store.batch(()=>{const s=this.getValue(),n=this.getMeta();s!==this.state.value&&this.store.setState(o=>({...o,value:s})),n!==this.state.meta&&this.store.setState(o=>({...o,meta:n}))})});this.update(this.options);const{onMount:i}=this.options.validators||{};if(i){const s=this.runValidator({validate:i,value:{value:this.state.value,fieldApi:this},type:"validate"});s&&this.setMeta(n=>({...n,errorMap:{...n==null?void 0:n.errorMap,onMount:s}}))}return()=>{const s=this.options.preserveValue;t(),s||this.form.deleteField(this.name)}},this.update=e=>{var t;if(this.state.value===void 0){const i=(t=e.form.options.defaultValues)==null?void 0:t[e.name];e.defaultValue!==void 0?this.setValue(e.defaultValue):i!==void 0&&this.setValue(i)}this._getMeta()===void 0&&this.setMeta(this.state.meta),this.options=e},this.getValue=()=>this.form.getFieldValue(this.name),this.setValue=(e,t)=>{this.form.setFieldValue(this.name,e,t),this.validate("change",this.state.value)},this._getMeta=()=>this.form.getFieldMeta(this.name),this.getMeta=()=>this._getMeta()??{isValidating:!1,isTouched:!1,isDirty:!1,isPristine:!0,touchedErrors:[],errors:[],errorMap:{},...this.options.defaultMeta},this.setMeta=e=>this.form.setFieldMeta(this.name,e),this.getInfo=()=>this.form.getFieldInfo(this.name),this.pushValue=e=>this.form.pushFieldValue(this.name,e),this.insertValue=(e,t)=>this.form.insertFieldValue(this.name,e,t),this.removeValue=e=>this.form.removeFieldValue(this.name,e),this.swapValues=(e,t)=>this.form.swapFieldValues(this.name,e,t),this.validateSync=(e=this.state.value,t)=>{const i=C(t,this.options);let s=!1;this.form.store.batch(()=>{for(const o of i){if(!o.validate)continue;const l=P(this.runValidator({validate:o.validate,value:{value:e,fieldApi:this},type:"validate"})),h=y(o.cause);this.state.meta.errorMap[h]!==l&&this.setMeta(u=>({...u,errorMap:{...u.errorMap,[y(o.cause)]:l}})),l&&(s=!0)}});const n=y("submit");return this.state.meta.errorMap[n]&&t!=="submit"&&!s&&this.setMeta(o=>({...o,errorMap:{...o.errorMap,[n]:void 0}})),{hasErrored:s}},this.validateAsync=async(e=this.state.value,t)=>{const i=N(t,this.options);this.state.meta.isValidating||this.setMeta(o=>({...o,isValidating:!0}));const s=[];for(const o of i){if(!o.validate)continue;const l=y(o.cause),h=this.getInfo().validationMetaMap[l];h==null||h.lastAbortController.abort();const u=new AbortController;this.getInfo().validationMetaMap[l]={lastAbortController:u},s.push(new Promise(async v=>{let m;try{m=await new Promise((c,p)=>{setTimeout(async()=>{if(u.signal.aborted)return c(void 0);try{c(await this.runValidator({validate:o.validate,value:{value:e,fieldApi:this,signal:u.signal},type:"validateAsync"}))}catch(g){p(g)}},o.debounceMs)})}catch(c){m=c}const b=P(m);this.setMeta(c=>({...c,errorMap:{...c==null?void 0:c.errorMap,[y(t)]:b}})),v(b)}))}let n=[];return s.length&&(n=await Promise.all(s)),this.setMeta(o=>({...o,isValidating:!1})),n.filter(Boolean)},this.validate=(e,t)=>{if(!this.state.meta.isTouched)return[];try{this.form.validate(e)}catch{}const{hasErrored:i}=this.validateSync(t,e);return i&&!this.options.asyncAlways?this.state.meta.errors:this.validateAsync(t,e)},this.handleChange=e=>{this.setValue(e,{touch:!0})},this.handleBlur=()=>{this.state.meta.isTouched||(this.setMeta(t=>({...t,isTouched:!0})),this.validate("change")),this.validate("blur")},this.form=r.form,this.name=r.name,r.defaultValue!==void 0&&this.form.setFieldValue(this.name,r.defaultValue),this.store=new I({value:this.getValue(),meta:this._getMeta()??{isValidating:!1,isTouched:!1,isDirty:!1,isPristine:!0,touchedErrors:[],errors:[],errorMap:{},...r.defaultMeta}},{onUpdate:()=>{const e=this.store.state;e.meta.errors=Object.values(e.meta.errorMap).filter(t=>t!==void 0),e.meta.touchedErrors=e.meta.isTouched?e.meta.errors:[],e.meta.isPristine=!e.meta.isDirty,this.prevState=e,this.state=e}}),this.state=this.store.state,this.prevState=this.state,this.options=r}runValidator(r){const e=[this.form.options.validatorAdapter,this.options.validatorAdapter];for(const t of e)if(t&&typeof r.validate!="function")return t()[r.type](r.value,r.validate);return r.validate(r.value)}}function P(a){if(a)return typeof a!="string"?"Invalid Form Values":a}function y(a){switch(a){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"change":default:return"onChange"}}function j(a,r=e=>e){return K.useSyncExternalStoreWithSelector(a.subscribe,()=>a.state,()=>a.state,r,et)}function et(a,r){if(Object.is(a,r))return!0;if(typeof a!="object"||a===null||typeof r!="object"||r===null)return!1;const e=Object.keys(a);if(e.length!==Object.keys(r).length)return!1;for(let t=0;t<e.length;t++)if(!Object.prototype.hasOwnProperty.call(r,e[t])||!Object.is(a[e[t]],r[e[t]]))return!1;return!0}var F=O;const A=typeof window<"u"?F.useLayoutEffect:F.useEffect;function D(a){const[r]=F.useState(()=>{const e=new tt({...a,form:a.form,name:a.name});return e.Field=$,e});return A(r.mount,[r]),A(()=>{r.update(a)}),j(r.store,a.mode==="array"?e=>[e.meta,Object.keys(e.value).length]:void 0),r}function $({children:a,...r}){const e=D(r);return d.jsx(d.Fragment,{children:S(a,e)})}function st(a){const[r]=F.useState(()=>{const e=new Z(a);return e.Field=function(i){return d.jsx($,{...i,form:e})},e.useField=t=>D({...t,form:e}),e.useStore=t=>j(e.store,t),e.Subscribe=t=>S(t.children,j(e.store,t.selector)),e});return A(r.mount,[]),r.useStore(e=>e.isSubmitting),A(()=>{r.update(a)}),r}const it="https://api.github.com/";async function at(a){try{const r=await G.request({method:"GET",url:`${it}users/${a}`});if(r.status!==200)throw new Error(`Failed to fetch user data for ${a}`);return r.data}catch(r){throw console.error("Error fetching user data:",r),r}}const rt=()=>{const a=L(),r=st({defaultValues:{userName:""},onSubmit:async({value:e})=>{a({to:`${e.userName}/repos`})}});return d.jsxs("form",{onSubmit:e=>{e.preventDefault(),e.stopPropagation(),r.handleSubmit()},className:"flex h-full w-full flex-col items-center justify-evenly bg-black p-8 lg:h-1/2 lg:w-1/3 lg:rounded-2xl",children:[d.jsxs("div",{children:[d.jsx("img",{className:"h-24 w-24",src:"https://assets-global.website-files.com/61d1b6e84887f53fef1dcdf2/631b45e07d98cfb364e5951f_github-white.png"}),d.jsx("h1",{className:"mt-1 text-center text-3xl text-white",children:"GitGo"})]}),d.jsxs("div",{className:"w-full",children:[d.jsx("h2",{className:"text-md item-left mb-1",children:"Enter you Github username:"}),d.jsx("div",{className:"mb-4 w-full",children:d.jsx(r.Field,{name:"userName",validators:{onChangeAsyncDebounceMs:300,onSubmit:({value:e})=>e?void 0:"A username is required",onChangeAsync:async({value:e})=>{try{await at(e);return}catch{return"No such username exists"}}},children:e=>d.jsxs("div",{className:"flex flex-col",children:[d.jsx("input",{name:e.name,value:e.state.value,onBlur:e.handleBlur,onChange:t=>e.handleChange(t.target.value),className:"rounded-md border border-gray-800 bg-gray-900 p-4 focus:outline-none focus:ring focus:ring-blue-300"}),e.state.meta.errors?d.jsx("em",{className:"text-purple-500",role:"alert",children:e.state.meta.errors.join(", ")}):null]})})}),d.jsx("button",{type:"submit",className:"w-full rounded-md bg-blue-400 px-4 py-4 text-white hover:bg-blue-600 focus:outline-none focus:ring focus:ring-blue-300",children:"Get your stats"})]})]})},ut=z("/")({component:nt});function nt(){return d.jsx("div",{className:"flex h-screen w-screen items-center justify-center",children:d.jsx(rt,{})})}export{ut as Route};
